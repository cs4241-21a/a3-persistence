var user = "Robert-Nelson";
var token = "00addee2eda20f65bb37c09192d556eb28374149";
var repo = "travis-test";

var Client = require('../');

client = new Client(
	{
		version: "3.0.0"
	}
);

client.authenticate(
	{
		"type": "oauth",
		"token": token
	}
);

var fs = require('fs');

var pkg = JSON.parse(fs.readFileSync('package.json', { encoding: 'utf8' }));

function doRelease() {
    var release = {
        "user": "Robert-Nelson",
        "repo": "openpgpjs",
        "tag_name": "LatestDev",
        "name": "v" + pkg.version + " (Unstable)",
        "body": "This is a test of auto release.",
        "prerelease": true
    };

    client.repos.getAllReleases(
        {
            "user": release.user,
            "repo": release.repo
        },
        function (err, res) {
            if (!err) {
                res.forEach(function (item) {
                    //if (item.tag_name == "LatestDev") {
                        release.id = item.id;
                        console.log("Release:\n", item);
                        client.repos.listReleaseAssets(
                            release,
                            function (err, assets) {
                                console.log("repos.listReleaseAssets:\n", err, assets);
                            }
                        );
                    //}
                });
            } else {
                console.log("repos.getAllReleases:\n", res);
            }
        }
    );
}

client.repos.updateFile(
    {
        "user": "open-sw",
        "repo": "api-test",
        "path": "testfile",
        "message": "Change file test commit.",
        "sha": "bce1946c23e8269454bca8ebafcdbfe0296fc05c",
        "content": new Buffer("Test file 2.\n", encoding="utf8").toString('base64')
    },
    function (err, res) {
        console.log("repos.createFile:\n", err, res);
    }
)
